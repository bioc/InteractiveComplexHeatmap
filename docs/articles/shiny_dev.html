<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Functions for Shiny app development • InteractiveComplexHeatmap</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Functions for Shiny app development">
<meta property="og:description" content="InteractiveComplexHeatmap">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">InteractiveComplexHeatmap</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.0.1015</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/InteractiveComplexHeatmap.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/implementation.html">How interactive ComplexHeatmap is implemented</a>
    </li>
    <li>
      <a href="../articles/shiny_dev.html">Functions for Shiny app development</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jokergoo/InteractiveComplexHeatmap/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="shiny_dev_files/header-attrs-2.5/header-attrs.js"></script><script src="shiny_dev_files/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="shiny_dev_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="shiny_dev_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Functions for Shiny app development</h1>
                        <h4 class="author">Zuguang Gu ( <a href="mailto:z.gu@dkfz.de" class="email">z.gu@dkfz.de</a> )</h4>
            
            <h4 class="date">2020-12-17</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jokergoo/InteractiveComplexHeatmap/blob/master/vignettes/shiny_dev.Rmd"><code>vignettes/shiny_dev.Rmd</code></a></small>
      <div class="hidden name"><code>shiny_dev.Rmd</code></div>

    </div>

    
    
<style>
p {
    margin: 1em 0;
}
</style>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h2>
<p><code><a href="../reference/ht_shiny.html">ht_shiny()</a></code> can export heatmaps as a stand-alone Shiny app. <strong>InteractiveComplexHeatmap</strong> also provides two functions for integrating the interactive heatmap widgets into other Shiny apps. The two functions are:</p>
<ul>
<li>
<code><a href="../reference/InteractiveComplexHeatmapOutput.html">InteractiveComplexHeatmapOutput()</a></code>: for building UI.</li>
<li>
<code><a href="../reference/MakeInteractiveComplexHeatmap.html">MakeInteractiveComplexHeatmap()</a></code>: for processing on the sever side.</li>
</ul>
<p>The usage is simple. Following is an example that you can directly copy and paste to your R session.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/InteractiveComplexHeatmap">InteractiveComplexHeatmap</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://shiny.rstudio.com">shiny</a></span><span class="op">)</span>

<span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="fl">100</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>
<span class="va">ht</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">m</span><span class="op">)</span>
<span class="va">ht</span> <span class="op">=</span> <span class="fu">draw</span><span class="op">(</span><span class="va">ht</span><span class="op">)</span>

<span class="va">ui</span> <span class="op">=</span> <span class="fu"><a href="https://shiny.rstudio.com/reference/shiny/latest/fluidPage.html">fluidPage</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">h3</a></span><span class="op">(</span><span class="st">"My first interactive ComplexHeatmap Shiny app"</span><span class="op">)</span>,
    <span class="fu"><a href="../reference/InteractiveComplexHeatmapOutput.html">InteractiveComplexHeatmapOutput</a></span><span class="op">(</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">server</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="../reference/MakeInteractiveComplexHeatmap.html">MakeInteractiveComplexHeatmap</a></span><span class="op">(</span><span class="va">ht</span>, <span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span>
<span class="op">}</span>

<span class="fu"><a href="https://shiny.rstudio.com/reference/shiny/latest/shinyApp.html">shinyApp</a></span><span class="op">(</span><span class="va">ui</span>, <span class="va">server</span><span class="op">)</span></code></pre></div>
<p><img src="app_demo1.png" width="100%"></p>
<p>You can also put multiple interactive heatmaps widgets in a single Shiny app, but this time you must assign a “heatmap id” for each one, so that <code><a href="../reference/MakeInteractiveComplexHeatmap.html">MakeInteractiveComplexHeatmap()</a></code> can find the correct heatmap to response. The heatmap id should start with letters.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ht1</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">m</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"blue"</span><span class="op">)</span><span class="op">)</span>
<span class="va">ht1</span> <span class="op">=</span> <span class="fu">draw</span><span class="op">(</span><span class="va">ht1</span><span class="op">)</span>
<span class="va">ht2</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">m</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span>
<span class="va">ht2</span> <span class="op">=</span> <span class="fu">draw</span><span class="op">(</span><span class="va">ht2</span><span class="op">)</span>

<span class="va">ui</span> <span class="op">=</span> <span class="fu"><a href="https://shiny.rstudio.com/reference/shiny/latest/fluidPage.html">fluidPage</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">h3</a></span><span class="op">(</span><span class="st">"The first heatmap"</span><span class="op">)</span>,
    <span class="fu"><a href="../reference/InteractiveComplexHeatmapOutput.html">InteractiveComplexHeatmapOutput</a></span><span class="op">(</span><span class="st">"heatmap_1"</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">hr</a></span><span class="op">(</span><span class="op">)</span>,
    <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/builder.html">h3</a></span><span class="op">(</span><span class="st">"The second heatmap"</span><span class="op">)</span>,
    <span class="fu"><a href="../reference/InteractiveComplexHeatmapOutput.html">InteractiveComplexHeatmapOutput</a></span><span class="op">(</span><span class="st">"heatmap_2"</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">server</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="../reference/MakeInteractiveComplexHeatmap.html">MakeInteractiveComplexHeatmap</a></span><span class="op">(</span><span class="va">ht1</span>, <span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span>, <span class="st">"heatmap_1"</span><span class="op">)</span>
    <span class="fu"><a href="../reference/MakeInteractiveComplexHeatmap.html">MakeInteractiveComplexHeatmap</a></span><span class="op">(</span><span class="va">ht2</span>, <span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span>, <span class="st">"heatmap_2"</span><span class="op">)</span>
<span class="op">}</span>

<span class="fu"><a href="https://shiny.rstudio.com/reference/shiny/latest/shinyApp.html">shinyApp</a></span><span class="op">(</span><span class="va">ui</span>, <span class="va">server</span><span class="op">)</span></code></pre></div>
<p><img src="app_demo2.png" width="100%"></p>
</div>
<div id="customize-the-widgets" class="section level2">
<h2 class="hasAnchor">
<a href="#customize-the-widgets" class="anchor"></a>Customize the widgets</h2>
<p>The <code>div</code> block of the original heatmap and the sub-heatmap can be resized by dragging the two boxes, but still, <code><a href="../reference/InteractiveComplexHeatmapOutput.html">InteractiveComplexHeatmapOutput()</a></code> has arguments <code>width1</code>, <code>width2</code>, <code>height1</code> and <code>height2</code> that control the initialize sizes of the two boxes. You can check <code><a href="../reference/ht_shiny_example.html">ht_shiny_example(16)</a></code> where the size of the heatmap box is manually set to make sure the heatmap is well visible.</p>
<p>By default, to get the information of a single cell in the heatmap, a “click” action is used. In <code><a href="../reference/InteractiveComplexHeatmapOutput.html">InteractiveComplexHeatmapOutput()</a></code>, you can also set the action to <code>"hover"</code> or <code>"dblclick"</code> to change the action. Note no matter the action is a click or a hover, when applying the brush action, click or hover will always be first applied and you will see the output for a single cell appears and fastly disappears. Currently I don’t have a solution for that.</p>
<p>The style of the brush can be specified by <code>brush_opt</code> argument. The value should be a list and the value will be sent to <code><a href="https://shiny.rstudio.com/reference/shiny/latest/brushOpts.html">shiny::brushOpts()</a></code>.</p>
</div>
<div id="work-with-r-markdown-documents" class="section level2">
<h2 class="hasAnchor">
<a href="#work-with-r-markdown-documents" class="anchor"></a>Work with R Markdown documents</h2>
<p>It is very straightforward to integrate <strong>InteractiveComplexHeatmap</strong> in an interactive R Markdown document, in a normal way of integrating normal Shiny widgets. Following is an example and you can run a real interactive document with heatmaps by <code><a href="../reference/ht_shiny_example.html">ht_shiny_example(22)</a></code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb3-1"><a href="#cb3-1"></a><span class="co">---</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="an">title:</span><span class="co"> "InteractiveComplexHeatmap in an Rmarkdown document"</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="an">author:</span><span class="co"> "Zuguang Gu"</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="an">date:</span><span class="co"> "16/12/2020"</span></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="an">output:</span><span class="co"> html_document</span></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="an">runtime:</span><span class="co"> shiny</span></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="co">---</span></span>
<span id="cb3-8"><a href="#cb3-8"></a></span>
<span id="cb3-9"><a href="#cb3-9"></a></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="in">library(InteractiveComplexHeatmap)</span></span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="in">m = matrix(rnorm(100*100), 100)</span></span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="in">ht = Heatmap(m)</span></span>
<span id="cb3-14"><a href="#cb3-14"></a><span class="in">```</span></span>
<span id="cb3-15"><a href="#cb3-15"></a></span>
<span id="cb3-16"><a href="#cb3-16"></a></span>
<span id="cb3-17"><a href="#cb3-17"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb3-18"><a href="#cb3-18"></a><span class="in">ui = fluidPage(</span></span>
<span id="cb3-19"><a href="#cb3-19"></a><span class="in">    InteractiveComplexHeatmapOutput()</span></span>
<span id="cb3-20"><a href="#cb3-20"></a><span class="in">)</span></span>
<span id="cb3-21"><a href="#cb3-21"></a></span>
<span id="cb3-22"><a href="#cb3-22"></a><span class="in">server = function(input, output, session) {</span></span>
<span id="cb3-23"><a href="#cb3-23"></a><span class="in">    MakeInteractiveComplexHeatmap(ht, input, output, session)</span></span>
<span id="cb3-24"><a href="#cb3-24"></a><span class="in">}</span></span>
<span id="cb3-25"><a href="#cb3-25"></a></span>
<span id="cb3-26"><a href="#cb3-26"></a><span class="in">shiny::shinyApp(ui, server)</span></span>
<span id="cb3-27"><a href="#cb3-27"></a><span class="in">```</span></span></code></pre></div>
<p><img src="rmarkdown.png" width="100%"></p>
</div>
<div id="self-define-the-output" class="section level2">
<h2 class="hasAnchor">
<a href="#self-define-the-output" class="anchor"></a>Self-define the output</h2>
<p>Both the click and brush action on the heatmap trigger an output below the heatmap. The output gives the information of which row(s) and columns(s) are selected by users. The reponse for the two actions can be self-defined.</p>
<p>In <code><a href="../reference/MakeInteractiveComplexHeatmap.html">MakeInteractiveComplexHeatmap()</a></code>, there are two arguments <code>click_action</code> and <code>brush_action</code> which accept self-defined functions and define how to response after the heatmap is clicked or brushed. The input for the two functions should accept two argumnts, one is a <code>DataFrame</code> object which contains the information of which row(s) and columns(s) are selected by users, and the second argument should always be <code>output</code> which is used in the Shiny app.</p>
<p>To use <code>click_action</code> or <code>brush_action</code>, a <code>htmlOutput</code> (or other similar <code>*Output</code>) should be first setup in the UI, then the Shiny app can know where to update the output.</p>
<p>The <code>click_action</code> or <code>brush_action</code> is basically defined as follows (assume the id set in <code><a href="https://shiny.rstudio.com/reference/shiny/latest/htmlOutput.html">htmlOutput()</a></code> is <code>"info"</code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">function</span><span class="op">(</span><span class="va">df</span>, <span class="va">output</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">output</span><span class="op">[[</span><span class="st">"info"</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://shiny.rstudio.com/reference/shiny/latest/renderUI.html">renderUI</a></span><span class="op">(</span><span class="op">{</span>  <span class="co"># or output$info = ...</span>
        <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
            <span class="va">...</span>
        <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
            <span class="va">...</span>
        <span class="op">}</span>
    <span class="op">}</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>If users didn’t click or brush in the heatmap body, <code>df</code> that is passed to the functions will be <code>NULL</code>. Users might need to perform a sanity check here and print specific output when the heatmap was not selected.</p>
<p>The format of <code>df</code> is slightly different between click and brush. If it is a click action, <code>df</code> has the same format as the returned object of <code><a href="../reference/selectPosition.html">selectPosition()</a></code> function, which looks like follows. It always has one row.</p>
<pre><code>## DataFrame with 1 row and 6 columns
##       heatmap                  slice row_slice column_slice row_index
##   &lt;character&gt;            &lt;character&gt; &lt;numeric&gt;    &lt;numeric&gt; &lt;integer&gt;
## 1       mat_a mat_a_heatmap_body_1_2         1            2         9
##   column_index
##      &lt;integer&gt;
## 1            1</code></pre>
<p>If it is a brush action, <code>df</code> has the same format as the returned object of <code><a href="../reference/selectArea.html">selectArea()</a></code> function, which looks like follows:</p>
<pre><code>## DataFrame with 4 rows and 6 columns
##       heatmap                  slice row_slice column_slice     row_index
##   &lt;character&gt;            &lt;character&gt; &lt;numeric&gt;    &lt;numeric&gt; &lt;IntegerList&gt;
## 1       mat_a mat_a_heatmap_body_1_2         1            2     7,5,2,...
## 2       mat_a mat_a_heatmap_body_2_2         2            2           6,3
## 3       mat_b mat_b_heatmap_body_1_1         1            1     7,5,2,...
## 4       mat_b mat_b_heatmap_body_2_1         2            1           6,3
##    column_index
##   &lt;IntegerList&gt;
## 1     2,4,1,...
## 2     2,4,1,...
## 3     1,2,3,...
## 4     1,2,3,...</code></pre>
<p>In the following example, in the UI, I add a new <code>htmlOutput</code> with id <code>info</code>. On the sever side, I define <code>click_action</code> to print a styled text and <code>brush_action</code> to print the table for the selected rows and columns from the heatmap. Note I also set <code>default_click_action = FALSE, default_brush_action = FALSE</code> in <code><a href="../reference/MakeInteractiveComplexHeatmap.html">MakeInteractiveComplexHeatmap()</a></code> to turn off the default responses.</p>
<p>You can also run the following example simply by <code><a href="../reference/ht_shiny_example.html">ht_shiny_example(20)</a></code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/GetoptLong">GetoptLong</a></span><span class="op">)</span>  <span class="co"># for the qq() function</span>
<span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="fl">100</span><span class="op">)</span>, <span class="fl">100</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"R"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"C"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span>
<span class="va">ht</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">m</span>, show_row_names <span class="op">=</span> <span class="cn">FALSE</span>, show_column_names <span class="op">=</span> <span class="cn">FALSE</span>, row_km <span class="op">=</span> <span class="fl">2</span>, column_km <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">ht</span> <span class="op">=</span> <span class="fu">draw</span><span class="op">(</span><span class="va">ht</span><span class="op">)</span>

<span class="va">ui</span> <span class="op">=</span> <span class="fu"><a href="https://shiny.rstudio.com/reference/shiny/latest/fluidPage.html">fluidPage</a></span><span class="op">(</span>
    <span class="fu"><a href="../reference/InteractiveComplexHeatmapOutput.html">InteractiveComplexHeatmapOutput</a></span><span class="op">(</span><span class="op">)</span>,
    <span class="fu"><a href="https://shiny.rstudio.com/reference/shiny/latest/htmlOutput.html">htmlOutput</a></span><span class="op">(</span><span class="st">"info"</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">click_action</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span>, <span class="va">output</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">output</span><span class="op">[[</span><span class="st">"info"</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://shiny.rstudio.com/reference/shiny/latest/renderUI.html">renderUI</a></span><span class="op">(</span><span class="op">{</span>
        <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
            <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/HTML.html">HTML</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/GetoptLong/man/qq.html">qq</a></span><span class="op">(</span><span class="st">"&lt;p style='background-color:#FF8080;color:white;padding:5px;'&gt;You have clicked on heatmap @{df$heatmap}, row @{df$row_index}, column @{df$column_index}&lt;/p&gt;"</span><span class="op">)</span><span class="op">)</span>
        <span class="op">}</span>
    <span class="op">}</span><span class="op">)</span>
<span class="op">}</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/">kableExtra</a></span><span class="op">)</span>
<span class="va">brush_action</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span>, <span class="va">output</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">row_index</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">row_index</span><span class="op">)</span>
    <span class="va">column_index</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">column_index</span><span class="op">)</span>
    <span class="va">output</span><span class="op">[[</span><span class="st">"info"</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://shiny.rstudio.com/reference/shiny/latest/renderUI.html">renderUI</a></span><span class="op">(</span><span class="op">{</span>
        <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
            <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/HTML.html">HTML</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html">kbl</a></span><span class="op">(</span><span class="va">m</span><span class="op">[</span><span class="va">row_index</span>, <span class="va">column_index</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>, digits <span class="op">=</span> <span class="fl">2</span>, format <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
        <span class="op">}</span>
    <span class="op">}</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">server</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="../reference/MakeInteractiveComplexHeatmap.html">MakeInteractiveComplexHeatmap</a></span><span class="op">(</span><span class="va">ht</span>, <span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span>,
        click_action <span class="op">=</span> <span class="va">click_action</span>, brush_action <span class="op">=</span> <span class="va">brush_action</span>,
        default_click_action <span class="op">=</span> <span class="cn">FALSE</span>, default_brush_action <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="op">}</span>

<span class="fu"><a href="https://shiny.rstudio.com/reference/shiny/latest/shinyApp.html">shinyApp</a></span><span class="op">(</span><span class="va">ui</span>, <span class="va">server</span><span class="op">)</span></code></pre></div>
<p><img src="customize_output.png" width="100%"></p>
<p><code><a href="../reference/ht_shiny_example.html">ht_shiny_example(21)</a></code> gives another scenario where the output needs to be self-defined. In that example, an gene expression matrix is visualized and clicking on the heatmap will print the corresponding gene and some other annotations related to this gene. Run <code><a href="../reference/ht_shiny_example.html">ht_shiny_example(21)</a></code> to see how this is implemented.</p>
<p><img src="customize_output2.png" width="100%"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Zuguang Gu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
