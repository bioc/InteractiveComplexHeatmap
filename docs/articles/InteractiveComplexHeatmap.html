<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>How to visualize heatmaps interactively • InteractiveComplexHeatmap</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="How to visualize heatmaps interactively">
<meta property="og:description" content="InteractiveComplexHeatmap">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">InteractiveComplexHeatmap</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.0.1003</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/InteractiveComplexHeatmap.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/implementation.html">How interactive ComplexHeatmap is implemented</a>
    </li>
    <li>
      <a href="../articles/shiny_dev.html">Functions for Shiny app development</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jokergoo/InteractiveComplexHeatmap/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="InteractiveComplexHeatmap_files/header-attrs-2.5/header-attrs.js"></script><script src="InteractiveComplexHeatmap_files/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="InteractiveComplexHeatmap_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="InteractiveComplexHeatmap_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>How to visualize heatmaps interactively</h1>
                        <h4 class="author">Zuguang Gu ( <a href="mailto:z.gu@dkfz.de" class="email">z.gu@dkfz.de</a> )</h4>
            
            <h4 class="date">2020-12-10</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jokergoo/InteractiveComplexHeatmap/blob/master/vignettes/InteractiveComplexHeatmap.Rmd"><code>vignettes/InteractiveComplexHeatmap.Rmd</code></a></small>
      <div class="hidden name"><code>InteractiveComplexHeatmap.Rmd</code></div>

    </div>

    
    
<style>
p {
    margin: 1em 0;
}
</style>
<p>The <strong>InteractiveComplexHeatmap</strong> package is very straightforward to use. For any heatmap (or list of heatmaps, in a <code>Heatmap</code> or <code>HeatmapList</code> object) produced from <strong>ComplexHeatmap</strong> package, you can just use the function <code><a href="../reference/ht_shiny.html">ht_shiny()</a></code> to export it in a Shiny app.</p>
<p>You can copy and paste the following code:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/InteractiveComplexHeatmap">InteractiveComplexHeatmap</a></span><span class="op">)</span>
<span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="fl">100</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>
<span class="va">ht</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">ht</span><span class="op">)</span>
<span class="va">ht</span> <span class="op">=</span> <span class="fu">draw</span><span class="op">(</span><span class="va">ht</span><span class="op">)</span>

<span class="fu"><a href="../reference/ht_shiny.html">ht_shiny</a></span><span class="op">(</span><span class="va">ht</span><span class="op">)</span></code></pre></div>
<p>A link will be opend in your web browser automatically (or a pop-up window in RStudio IDE).</p>
<p>To use <code><a href="../reference/ht_shiny.html">ht_shiny()</a></code>, the <code>Heatmap</code>/<code>HeatmapList</code> object is not necessary to be updated with <code>draw()</code> and it will be applied inside <code><a href="../reference/ht_shiny.html">ht_shiny()</a></code> automatically. However, updating by <code>draw()</code> will speed up the loading of the Shiny app because <code>draw()</code> applies clustering (which is normally the most time-consuming part) and saves it into the heatmap object. If your heatmap includes randomness, such as k-means clustring by setting <code>row_km</code> or <code>column_km</code> argument, then you must execute <code>draw()</code> before sending to <code><a href="../reference/ht_shiny.html">ht_shiny()</a></code>.</p>
<p>Please visit <a href="https://jokergoo.shinyapps.io/interactive_complexheatmap/" class="uri">https://jokergoo.shinyapps.io/interactive_complexheatmap/</a> for a live demo.</p>
<p>The following code demostrates two vertically concatenated heatmaps. Check <a href="https://jokergoo.shinyapps.io/interactive_complexheatmap_vertical/" class="uri">https://jokergoo.shinyapps.io/interactive_complexheatmap_vertical/</a> for a live demo.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ht_list</span> <span class="op">=</span> <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat1</span>, name <span class="op">=</span> <span class="st">"mat_a"</span>, row_km <span class="op">=</span> <span class="fl">2</span>, column_km <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">%v%</span>
    <span class="fu">Heatmap</span><span class="op">(</span><span class="va">mat2</span>, name <span class="op">=</span> <span class="st">"mat_b"</span><span class="op">)</span>
<span class="fu"><a href="../reference/ht_shiny.html">ht_shiny</a></span><span class="op">(</span><span class="va">ht_list</span><span class="op">)</span></code></pre></div>
<p><code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/densityHeatmap.html">ComplexHeatmap::densityHeatmap()</a></code> returns a <code>Heatmap</code> object, so it can also be exported into a Shiny app. Check <a href="https://jokergoo.shinyapps.io/interactive_densityheatmap/" class="uri">https://jokergoo.shinyapps.io/interactive_densityheatmap/</a> for a live demo.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ht</span> <span class="op">=</span> <span class="fu">densityHeatmap</span><span class="op">(</span><span class="va">mat1</span><span class="op">)</span>
<span class="fu"><a href="../reference/ht_shiny.html">ht_shiny</a></span><span class="op">(</span><span class="va">ht</span><span class="op">)</span></code></pre></div>
<p><a href="https://www.bioconductor.org/packages/release/bioc/html/EnrichedHeatmap.html"><strong>EnrichedHeatmap</strong></a> also outputs <code>Heatmap</code> objects, thus, an “enriched heatmap” can be exported into a Shiny app as well. Check <a href="https://jokergoo.shinyapps.io/interactive_enrichedheatmap/" class="uri">https://jokergoo.shinyapps.io/interactive_enrichedheatmap/</a> for a live demo.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/EnrichedHeatmap">EnrichedHeatmap</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"chr21_test_data.RData"</span>, package <span class="op">=</span> <span class="st">"EnrichedHeatmap"</span><span class="op">)</span><span class="op">)</span>
<span class="va">mat_meth</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/EnrichedHeatmap/man/normalizeToMatrix.html">normalizeToMatrix</a></span><span class="op">(</span><span class="va">meth</span>, <span class="va">cgi</span>, value_column <span class="op">=</span> <span class="st">"meth"</span>, 
  mean_mode <span class="op">=</span> <span class="st">"absolute"</span>, extend <span class="op">=</span> <span class="fl">5000</span>, w <span class="op">=</span> <span class="fl">50</span>, smooth <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">ht</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/EnrichedHeatmap/man/EnrichedHeatmap.html">EnrichedHeatmap</a></span><span class="op">(</span><span class="va">mat_meth</span>, name <span class="op">=</span> <span class="st">"methylation"</span>, 
  column_title <span class="op">=</span> <span class="st">"methylation near CGI"</span><span class="op">)</span>
<span class="fu"><a href="../reference/ht_shiny.html">ht_shiny</a></span><span class="op">(</span><span class="va">ht</span><span class="op">)</span></code></pre></div>
<p>Since <strong>ComplexHeatmap</strong> can <a href="https://jokergoo.github.io/2020/05/06/translate-from-pheatmap-to-complexheatmap/">seamlessly integrate <strong>pheatmap</strong></a>, this means your pheatmap can be interactive!</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ht</span> <span class="op">=</span> <span class="fu">pheatmap</span><span class="op">(</span><span class="va">mat1</span><span class="op">)</span>
<span class="fu"><a href="../reference/ht_shiny.html">ht_shiny</a></span><span class="op">(</span><span class="va">ht</span><span class="op">)</span></code></pre></div>
<p>Following screenshot demonstrates the Shiny app on rather complex heatmaps. The data is from <a href="http://jokergoo.github.io/supplementary/ComplexHeatmap-supplementary1-4/supplS2_scRNASeq/supplS2_scRNAseq.html">here</a> with slightly changing the original code for making heatmaps.</p>
<p>In this Shiny app, users can click on the orignal heatmap or select an area from it. The information of the area selected by users can be found in the text below the heatmaps. If an area is selected, the row and column indices for all selected heatmaps can be obtained from a automatically generated sourcable code, which can also be found below the heatmap. Both heatmaps can be resized by dragging from the bottom right.</p>
<p>
<img width="100%" style="border:1px solid grey;padding: 4px;" src="example3.gif"></p>
<p>Please note, if the heatmap is too huge or you resize the heatmap too frequently, the heatmap might not be correctly updated. You can just slightly resize the heatmap again and wait for several seconds (you might have already observed from the previous screenshot that the right heatmap was not properly drawn when I first resized it).</p>
<p>There are two other vignettes focusing on more specific topics:</p>
<ul>
<li><a href="implementation.html">How interactive ComplexHeatmap is implemented</a></li>
<li><a href="shiny_dev.html">Functions for Shiny app development</a></li>
</ul>
<p><br><br><br><br><br><br><br><br></p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Zuguang Gu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
